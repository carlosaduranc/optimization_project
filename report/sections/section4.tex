\section{Model Predictive Control}
\label{sec:mpc}
Following the identification of the model done in section \ref{sec:trajectory_optimization}, an optimal control strategy was developed for the deployment of the zone heating by means of model predictive control (MPC). First, a primal optimal problem was developed for the MPC application which resulted in a significant decrease in energy consumption and therefore energy costs. Nevertheless, due to the constraint nature of primal optimal problems, the robustness of the control was a matter of concern. Due to this, a second approach following a lagrangian problem statement was developed. This allowed for the relaxation of the constraints, leading to a more robust control. The details pertaining both approaches are thoroughly explained in their corresponding subsections in the following.

\subsection{Primal MPC}
\label{subsec:primal_mpc}
As a first step, the calculated constants from section \ref{sec:trajectory_optimization} were used to develop the model. 

\begin{equation}
\underset{\dot{Q}_h}{\text{min}} \hspace{1em} \sum_{i=1}^{N} \left(\dot{Q}_{h,i}\right)^2
\end{equation}
\begin{equation}
\text{s.t.}  \hspace{1em} T_{z,i+1} - \Delta t \left( \frac{\dot{Q}_{h,i} + gA \cdot \dot{Q}_{sun, i} + \dot{Q}_{g,i}}{C_z} + \frac{T_{z,i}-T_{a,i}}{R_w \cdot C_z} \right) - T_{z,i} =0
\end{equation}
\begin{align}
T_{z,i} - 298.15 &\leq 0 \hspace{2em} \forall i \in \text{occupied}\\[0.5em]
293.15 - T_{z,i} &\leq 0 \hspace{2em} \forall i \in \text{occupied}\\[0.5em]
\dot{Q}_{h,i} - 1000 &\leq 0\\[0.5em]
-\dot{Q}_{h,i} &\leq 0
\end{align}


\subsection{Lagrangian MPC}
\label{subsec:lagrangian_mpc}
